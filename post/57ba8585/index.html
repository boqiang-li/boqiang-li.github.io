<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.boqiangli.com","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.13.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":null,"post_body":null,"coll_header":null,"sidebar":"fadeIn"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"algolia":{"appID":"ACZSSY9M5F","apiKey":"f9ad8b3b4fbcdbfe16684e6ffb28b587","indexName":"hexo","hits":{"per_page":10}}}</script><script src="/js/config.js"></script>

    <meta name="description" content="Learn the basics of ECL, the powerful programming language built for big data analytics.">
<meta property="og:type" content="article">
<meta property="og:title" content="Learning ECL Programming language">
<meta property="og:url" content="https://www.boqiangli.com/post/57ba8585/index.html">
<meta property="og:site_name" content="Boqiang&#39;s Blog">
<meta property="og:description" content="Learn the basics of ECL, the powerful programming language built for big data analytics.">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-06-03T09:35:12.000Z">
<meta property="article:modified_time" content="2023-06-11T04:11:53.712Z">
<meta property="article:author" content="Boqiang">
<meta property="article:tag" content="HPCC Systems">
<meta property="article:tag" content="ECL">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://www.boqiangli.com/post/57ba8585/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://www.boqiangli.com/post/57ba8585/","path":"/post/57ba8585/","title":"Learning ECL Programming language"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Learning ECL Programming language | Boqiang's Blog</title>
  





<link rel="dns-prefetch" href="waline.boqiangli.com">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Boqiang's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/Tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-categories"><a href="/Categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container"></div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container">
  <div class="algolia-stats"><hr></div>
  <div class="algolia-hits"></div>
  <div class="algolia-pagination"></div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#file-type"><span class="nav-number">1.</span> <span class="nav-text">File type</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#define-variables"><span class="nav-number">2.</span> <span class="nav-text">Define variables</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#basic-variable-type"><span class="nav-number">3.</span> <span class="nav-text">Basic variable type</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#boolean"><span class="nav-number">3.1.</span> <span class="nav-text">Boolean</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#value"><span class="nav-number">3.2.</span> <span class="nav-text">Value</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#integer"><span class="nav-number">3.3.</span> <span class="nav-text">INTEGER</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#set"><span class="nav-number">3.4.</span> <span class="nav-text">Set</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#keywords"><span class="nav-number">4.</span> <span class="nav-text">Keywords</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#export"><span class="nav-number">4.1.</span> <span class="nav-text">EXPORT</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#data-structure"><span class="nav-number">5.</span> <span class="nav-text">Data structure</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#enum"><span class="nav-number">5.1.</span> <span class="nav-text">ENUM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#record"><span class="nav-number">5.2.</span> <span class="nav-text">RECORD</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dataset"><span class="nav-number">5.3.</span> <span class="nav-text">DATASET</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#built-in-functions-and-operations"><span class="nav-number">6.</span> <span class="nav-text">Built-in functions and
operations</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#output"><span class="nav-number">6.1.</span> <span class="nav-text">OUTPUT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#table"><span class="nav-number">6.2.</span> <span class="nav-text">TABLE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#project"><span class="nav-number">6.3.</span> <span class="nav-text">PROJECT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#transform"><span class="nav-number">6.4.</span> <span class="nav-text">TRANSFORM</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#normalize"><span class="nav-number">6.5.</span> <span class="nav-text">NORMALIZE</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#join"><span class="nav-number">6.6.</span> <span class="nav-text">JOIN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#embed"><span class="nav-number">6.7.</span> <span class="nav-text">EMBED</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#local"><span class="nav-number">6.8.</span> <span class="nav-text">LOCAL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#assert"><span class="nav-number">6.9.</span> <span class="nav-text">ASSERT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#sort"><span class="nav-number">6.10.</span> <span class="nav-text">SORT</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#max"><span class="nav-number">6.11.</span> <span class="nav-text">MAX</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#count"><span class="nav-number">6.12.</span> <span class="nav-text">COUNT</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Boqiang</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/Tags/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://www.boqiangli.com/post/57ba8585/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Boqiang">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Boqiang's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Learning ECL Programming language | Boqiang's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Learning ECL Programming language
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 06-03-2023 05:35:12" itemprop="dateCreated datePublished" datetime="2023-06-03T05:35:12-04:00">06-03-2023</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 06-11-2023 00:11:53" itemprop="dateModified" datetime="2023-06-11T00:11:53-04:00">06-11-2023</time>
    </span>

  
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Comments: </span>
  
    <a title="waline" href="/post/57ba8585/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/post/57ba8585/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-item" title="Views">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span class="waline-pageview-count" data-path="/post/57ba8585/"></span>
    </span>
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>Learn the basics of ECL, the powerful programming language built for
big data analytics.</p>
<span id="more"></span>
<h1 id="file-type">File type</h1>
<p>There are two kinds of operations in ECL, definition (Definitions)
and execution (Actions). After using EXPORT to execute the definition
operation, it will no longer be able to perform operations in this
file.</p>
<p>Similarly, ECL has two kinds of files. Their suffixes are
<code>.ecl</code>. Definitions file and build execution (BWR, Builder
Window Runnable) file. The difference is</p>
<ol type="1">
<li>The definition file always contains EXPORT and SHARED definitions
and contains no execution operations. Therefore, the file cannot be
executed through Submit.</li>
<li>The BWR file contains at least one execution operation and no EXPORT
and SHARED definition operations.</li>
</ol>
<h1 id="define-variables">Define variables</h1>
<p>Variable names cannot have spaces and end with a semicolon. Format
for defining variables:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[Scope] [ValueType] Name [ (parms) ] := Expression [ :WorkflowService] ;</span><br></pre></td></tr></table></figure>
<p>For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">My_First_Definition1 := 5; // valid name</span><br><span class="line">My First Definition := 5;  // INVALID name, spaces not allowed</span><br><span class="line">MyFirstDefinition := 5; //defined as 5</span><br><span class="line">MySecondDefinition := MyFirstDefinition + 5; //this is 10</span><br></pre></td></tr></table></figure>
<p>Variable name cannot start with
<code>UNICODE_ , UTF8_, VARUNICODE_</code></p>
<h1 id="basic-variable-type">Basic variable type</h1>
<h2 id="boolean">Boolean</h2>
<p>Boolean can be defined by expression, <code>TRUE</code> or
<code>FALSE</code>, for example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IsBoolTrue  := TRUE;</span><br><span class="line">IsFloridian := Person.per_st = &#x27;FL&#x27;;</span><br><span class="line">IsOldPerson := Person.Age &gt;= 65;</span><br></pre></td></tr></table></figure>
<h2 id="value">Value</h2>
<p>Value can be defined by an expression, and the result must be an
arithmetic value or a string:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ValueTrue      := 1;</span><br><span class="line">FloridianCount := COUNT(Person(Person.per_st = &#x27;FL&#x27;));</span><br><span class="line">OldAgeSum     := SUM(Person(Person.Age &gt;= 65),Person.Age);</span><br></pre></td></tr></table></figure>
<h2 id="integer">INTEGER</h2>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[IntType] [UNSIGNED] INTEGER[n]</span><br><span class="line">[IntType] UNSIGNEDn</span><br></pre></td></tr></table></figure>
<p>Among them, n indicates that this integer occupies <strong>number of
bytes</strong>, which can be 1~8. The default is 8.</p>
<p><em>IntType</em> describes whether the high bit of the number is at
the low address or the low bit is at the low address. Can take either
<code>BIG_ENDIAN</code> or <code>LITTLE_ENDIAN</code>. Default is
<code>LITTLE_ENDIAN</code>.</p>
<p>UNSIGNED, used to describe whether it is signed or not, the default
is signed.</p>
<p><strong>REAL[** <em>n</em> **]</strong> represents a floating point
number, n can be 4 (7 significant figures) or 8 (15 significant
figures)</p>
<h2 id="set">Set</h2>
<p>All elements must be of the same type.</p>
<p>Example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SetInts  := [1,2,3,4,5]; // an INTEGER set with 5 elements</span><br><span class="line">SetExp := [1,2+3,45,SomeIntegerDefinition,7*3];</span><br><span class="line">SetSomeField := SET(SomeFile, SomeField);</span><br></pre></td></tr></table></figure>
<p>SET can be accessed by subscript, <strong>subscript starts from
1</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MySet := [5,4,3,2,1];</span><br><span class="line">ReverseNum := MySet[2]; //indexing to MySet&#x27;s element number 2,</span><br><span class="line">                       //so ReverseNum contains the value 4</span><br></pre></td></tr></table></figure>
<p>Strings are treated as SET with multiple 1-character elements, so
they can also be accessed by subscript</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">MyString := &#x27;ABCDE&#x27;;</span><br><span class="line">MySubString := MyString[2]; // MySubString is &#x27;B&#x27;</span><br></pre></td></tr></table></figure>
<p>Strings support range access:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">MyString := &#x27;ABCDE&#x27;;</span><br><span class="line">MySubString1 := MyString[2..4]; // MySubString1 is &#x27;BCD&#x27;</span><br><span class="line">MySubString2 := MyString[ ..4]; // MySubString2 is &#x27;ABCD&#x27;</span><br><span class="line">MySubString3 := MyString[2.. ]; // MySubString3 is &#x27;BCDE&#x27;</span><br></pre></td></tr></table></figure>
<p>The data type in the Set can be specified:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SET OF INTEGER1 SetValues := [5,10,15,20];</span><br><span class="line"></span><br><span class="line">IsInSetFunction(SET OF INTEGER1 x=SetValues,y) := y IN x;</span><br><span class="line"></span><br><span class="line">OUTPUT(IsInSetFunction([1,2,3,4],5)); //false</span><br><span class="line">OUTPUT(IsInSetFunction(,5)); // true</span><br></pre></td></tr></table></figure>
<h1 id="keywords">Keywords</h1>
<h2 id="export">EXPORT</h2>
<p>How to use: <strong>EXPORT</strong> <strong>[ VIRTUAL ]</strong>
<em>definition</em>, <strong>only one</strong> EXPORT Module is allowed
in each file, and the name of this Module must be the
<strong>same</strong> as the file name.</p>
<p>VIRTUAL is optional. If specified, the definition is only valid
within the Module. Allows usage as Module.Definition from other
files.</p>
<p>EXPORT allows nesting. If you want to access a value in Module from
another file, this value must also be modified by EXPORT.</p>
<p>Example, file1:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EXPORT file1 := MODULE</span><br><span class="line">  Value1 := 5;</span><br><span class="line">  EXPORT Value2 :=6;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
<p>file2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IMPORT MyTest;</span><br><span class="line">myVar := MyTest.Value2;</span><br><span class="line">//myVar := MyTest.Value1; // 报错，Value1不可见</span><br><span class="line">OUTPUT(myVar);    //输出6</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="data-structure">Data structure</h1>
<h2 id="enum">ENUM</h2>
<p>Enums can be useful when you want to represent a limited set of
possible values for a variable or a parameter. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Color := ENUM(RED=1, GREEN=2, BLUE=3);</span><br><span class="line">myColor := Color.RED;</span><br><span class="line"></span><br><span class="line">OUTPUT(myColor);  # 1</span><br></pre></td></tr></table></figure>
<h2 id="record">RECORD</h2>
<p>A <code>RECORD</code> in ECL represents the structure or format of a
dataset. It is similar to the concept of a "table" in a SQL database,
where each field in the record is similar to a column in the table. It
defines the data types and names of fields.</p>
<p>For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ChildRec := RECORD</span><br><span class="line">    UNSIGNED4 person_id;</span><br><span class="line">    STRING20 per_surname;</span><br><span class="line">    STRING20 per_forename;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">rec := RECORD</span><br><span class="line">  STRING20 name;</span><br><span class="line">  INTEGER4 age;</span><br><span class="line">  BOOLEAN isEmployed;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
<p>usually used with <code>DATASET</code>.</p>
<h2 id="dataset">DATASET</h2>
<p>It represents a set of data. A dataset is a group of records with the
same record layout. A record layout is defined using the
<code>RECORD</code> structure, which contains a set of fields, each with
a name and a type.</p>
<p>How to use:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">attr := DATASET( file, struct, filetype [,LOOKUP]);</span><br><span class="line"></span><br><span class="line">attr := DATASET( dataset, file, filetype [,LOOKUP]);</span><br><span class="line"></span><br><span class="line">attr := DATASET( WORKUNIT( [ wuid , ] namedoutput ), struct );</span><br><span class="line"></span><br><span class="line">[ attr := ] DATASET( recordset [, recstruct ] );</span><br><span class="line"></span><br><span class="line">DATASET( row )</span><br><span class="line"></span><br><span class="line">DATASET( childstruct [, COUNT( count ) | LENGTH( size ) ] [, CHOOSEN( maxrecs ) ] )</span><br><span class="line"></span><br><span class="line">[GROUPED] [LINKCOUNTED] [STREAMED] DATASET( struct )</span><br><span class="line"></span><br><span class="line">DATASET( dict )</span><br><span class="line"></span><br><span class="line">DATASET( count, transform [, DISTRIBUTED | LOCAL ] )</span><br></pre></td></tr></table></figure>
<p>Example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rec := RECORD</span><br><span class="line">  STRING20 name;</span><br><span class="line">  INTEGER4 age;</span><br><span class="line">  BOOLEAN isEmployed;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">myData := DATASET([&#123; &#x27;John&#x27;, 30, TRUE &#125;, &#123; &#x27;Jane&#x27;, 25, FALSE &#125;], rec);</span><br><span class="line"></span><br><span class="line">OUTPUT(myData)</span><br></pre></td></tr></table></figure>
<p>Construct the dataset:</p>
<p>Use
<code>DATASET( count, transform [, DISTRIBUTED | LOCAL ] )</code>, for
example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">RAND_MAX := POWER(2,32) -1;</span><br><span class="line">trainCount := 1000;</span><br><span class="line">featureCount := 5;</span><br><span class="line">trainRec := RECORD</span><br><span class="line">  UNSIGNED8 id;</span><br><span class="line">  SET OF REAL x;</span><br><span class="line">  REAL4 y;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">REAL4 targetFunc(REAL4 x1, REAL4 x2, REAL4 x3, REAL4 x4, REAL4 x5) := FUNCTION</span><br><span class="line">  rslt := .5 * POWER(x1, 4) - .4 * POWER(x2, 3) + .3 * POWER(x3,2) - .2 * x4 + .1 * x5;</span><br><span class="line">  RETURN rslt;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">train0 := DATASET(trainCount, TRANSFORM(trainRec,</span><br><span class="line">                      SELF.id := COUNTER,</span><br><span class="line">                      SELF.x := [(RANDOM() % RAND_MAX) / RAND_MAX -.5,</span><br><span class="line">                                  (RANDOM() % RAND_MAX) / RAND_MAX -.5,</span><br><span class="line">                                  (RANDOM() % RAND_MAX) / RAND_MAX -.5,</span><br><span class="line">                                  (RANDOM() % RAND_MAX) / RAND_MAX -.5,</span><br><span class="line">                                  (RANDOM() % RAND_MAX) / RAND_MAX -.5],</span><br><span class="line">                      SELF.y := targetFunc(SELF.x[1], SELF.x[2], SELF.x[3], SELF.x[4], SELF.x[5]))</span><br><span class="line">                      );</span><br><span class="line">OUTPUT(train0, NAMED(&#x27;trainData&#x27;));</span><br><span class="line"></span><br><span class="line">// select the first record</span><br><span class="line">record1 := CHOOSEN(train0, 1);</span><br><span class="line"></span><br><span class="line">// extract the x field</span><br><span class="line">xField := PROJECT(record1, TRANSFORM(&#123;SET OF REAL x&#125;, SELF.x := LEFT.x));</span><br><span class="line"></span><br><span class="line">// output x field</span><br><span class="line">OUTPUT(xField, NAMED(&#x27;xFieldOfRecord1&#x27;));</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="built-in-functions-and-operations">Built-in functions and
operations</h1>
<h2 id="output">OUTPUT</h2>
<p>This function is for output values.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[attr := ] OUTPUT(recordset [, [ format ] [,file [thorfileoptions ] ] [, NOXPATH ] [, UNORDERED | ORDERED( bool ) ] [, STABLE | UNSTABLE ] [, PARALLEL [ ( numthreads ) ] ] [, ALGORITHM( name ) ] );</span><br><span class="line"></span><br><span class="line">[attr := ] OUTPUT(recordset, [ format ] ,file , CSV [ (csvoptions) ] [csvfileoptions ] [, NOXPATH ] [, UNORDERED | ORDERED( bool ) ] [, STABLE | UNSTABLE ] [, PARALLEL [ ( numthreads ) ] ] [, ALGORITHM( name ) ] );</span><br><span class="line"></span><br><span class="line">[attr := ] OUTPUT(recordset, [ format ] , file , XML [ (xmloptions) ] [xmlfileoptions ] [, NOXPATH ] [, UNORDERED | ORDERED( bool ) ] [, STABLE | UNSTABLE ] [, PARALLEL [ ( numthreads ) ] ] [, ALGORITHM( name ) ] );</span><br><span class="line"></span><br><span class="line">[attr := ] OUTPUT(recordset, [ format ] , file , JSON [ (jsonoptions) ] [jsonfileoptions ] [, NOXPATH ] [, UNORDERED | ORDERED( bool ) ] [, STABLE | UNSTABLE ] [, PARALLEL [ ( numthreads ) ] ] [, ALGORITHM( name ) ] );</span><br><span class="line"></span><br><span class="line">[attr := ] OUTPUT(recordset, [ format ] ,PIPE( pipeoptions [, NOXPATH ] [, UNORDERED | ORDERED( bool ) ] [, STABLE | UNSTABLE ] [, PARALLEL [ ( numthreads ) ] ] [, ALGORITHM( name ) ] );</span><br><span class="line"></span><br><span class="line">[attr := ] OUTPUT(recordset [, format ] , NAMED( name ) [,EXTEND] [,ALL] [, NOXPATH ] [, UNORDERED | ORDERED( bool ) ] [, STABLE | UNSTABLE ] [, PARALLEL [ ( numthreads ) ] ] [, ALGORITHM( name ) ] );</span><br><span class="line"></span><br><span class="line">[attr := ] OUTPUT( expression [, NAMED( name ) ] [, NOXPATH ] [, UNORDERED | ORDERED( bool ) ] [, STABLE | UNSTABLE ] [, PARALLEL [ ( numthreads ) ] ] [, ALGORITHM( name ) ] );</span><br><span class="line"></span><br><span class="line">[attr := ] OUTPUT( recordset , THOR [, NOXPATH ] [, UNORDERED | ORDERED( bool ) ] [, STABLE | UNSTABLE ] [, PARALLEL [ ( numthreads ) ] ] [, ALGORITHM( name ) ] );</span><br></pre></td></tr></table></figure>
<p>For example, to output 111 to the test panel, you can write:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OUTPUT(1111, NAMED(&#x27;test&#x27;));</span><br></pre></td></tr></table></figure>
<h2 id="table">TABLE</h2>
<p>Used to create a new dataset (Dataset). The <code>TABLE</code>
function takes a set of records (each defined by a <code>RECORD</code>
structure) and an optional filter condition, and returns a new
dataset.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">person := RECORD</span><br><span class="line">  STRING20 name;</span><br><span class="line">  UNSIGNED1 age;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">people := DATASET</span><br><span class="line">  (</span><br><span class="line">    [ </span><br><span class="line">      &#123;&#x27;John&#x27;, 30 &#125;,</span><br><span class="line">      &#123;&#x27;Jane&#x27;, 25 &#125;,</span><br><span class="line">      &#123;&#x27;Tom&#x27;, 35 &#125;</span><br><span class="line">    ], </span><br><span class="line">    person</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">adults := TABLE</span><br><span class="line">  (</span><br><span class="line">    people, </span><br><span class="line">    &#123;</span><br><span class="line">      STRING20 name := name;</span><br><span class="line">      UNSIGNED1 age := age;</span><br><span class="line">      BOOLEAN isAdult := age &gt;= 18;</span><br><span class="line">    &#125;</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">OUTPUT(adults);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="project">PROJECT</h2>
<p>Execute the TRANSFORM operation on each item in the DATASET.</p>
<h2 id="transform">TRANSFORM</h2>
<p>Convert one DATASET to another DATASET according to the rules.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">IMPORT STD;</span><br><span class="line"></span><br><span class="line">Layout_Person := RECORD</span><br><span class="line">  STRING1 num;</span><br><span class="line">  STRING4 name;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">Layout_Output := RECORD</span><br><span class="line">  Layout_Person;</span><br><span class="line">  STRING4 upper_name;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">ds_Persons := DATASET([&#123;&#x27;1&#x27;, &#x27;one&#x27;&#125;, &#123;&#x27;2&#x27;, &#x27;two&#x27;&#125;, &#123;&#x27;3&#x27;, &#x27;three&#x27;&#125;], Layout_Person);</span><br><span class="line"></span><br><span class="line">ds_Output := PROJECT(ds_Persons,</span><br><span class="line">                    TRANSFORM(Layout_Output,</span><br><span class="line">                              SELF.num := LEFT.num,</span><br><span class="line">                              SELF.name := LEFT.name,</span><br><span class="line">                              SELF.upper_name := STD.Str.ToUpperCase(LEFT.name)));</span><br><span class="line"></span><br><span class="line">OUTPUT(ds_Output);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>result:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1	one 	ONE </span><br><span class="line">2	two 	TWO </span><br><span class="line">3	thre	THRE</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="normalize">NORMALIZE</h2>
<p>In PROJECT, the TRANSFORM operation is performed on each piece of
data, and then a new data set is obtained, which is one-to-one in
quantity. And NORMALIZE is to expand a single piece of data into
multiple pieces of data. In some cases, you may have a field that
contains repeated data, and you may wish to split each repetition into a
separate record. In this case, you can use the <code>NORMALIZE</code>
function. The <code>NORMALIZE</code> function is used by receiving a
dataset and a TRANSFORM function and returning a new dataset. In the
conversion function, you need to define how to split the original
records into new records.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Layout := RECORD</span><br><span class="line">  STRING10 name;</span><br><span class="line">  INTEGER4 times;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">ds := DATASET([&#123;&#x27;John&#x27;, 3&#125;, &#123;&#x27;Jane&#x27;, 2&#125;], Layout);</span><br><span class="line"></span><br><span class="line">Layout_Output := RECORD</span><br><span class="line">  STRING10 name;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">ds_Output := NORMALIZE(ds, LEFT.times,</span><br><span class="line">                       TRANSFORM(Layout_Output,</span><br><span class="line">                                 SELF.name := LEFT.name));</span><br><span class="line"></span><br><span class="line">OUTPUT(ds_Output);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><code>ds.times</code> indicates the number of times to repeat, and
the <code>TRANSFORM</code> function defines how to convert the original
record into a new record. In the output dataset, <code>John</code> and
<code>Jane</code> will appear 3 and 2 times, respectively. Note that in
the <code>NORMALIZE</code> function, for the current data, use LEFT
reference.</p>
<h2 id="join">JOIN</h2>
<p>Merge the two DATASETs.</p>
<p><strong>JOIN(</strong> <em>leftrecset, rightrecset,
joincondition</em> <strong>[** <em>, transform</em> **] [** <em>,
jointype</em> **] [** <em>, joinflags</em> **] )</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Layout := RECORD</span><br><span class="line">  STRING1 id;</span><br><span class="line">  STRING10 name;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">Layout2 := RECORD</span><br><span class="line">  STRING1 id;</span><br><span class="line">  STRING10 job;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">OutputLayout := RECORD</span><br><span class="line">  STRING1 id;</span><br><span class="line">  STRING20 name;  </span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">ds1 := DATASET([&#123;&#x27;1&#x27;, &#x27;John&#x27;&#125;, &#123;&#x27;2&#x27;, &#x27;Jane&#x27;&#125;], Layout);</span><br><span class="line">ds2 := DATASET([&#123;&#x27;1&#x27;, &#x27;Engineer&#x27;&#125;, &#123;&#x27;2&#x27;, &#x27;Doctor&#x27;&#125;], Layout2);</span><br><span class="line"></span><br><span class="line">ds_join := JOIN(ds1, ds2, LEFT.id = RIGHT.id,</span><br><span class="line">                TRANSFORM(OutputLayout,</span><br><span class="line">                          SELF.id := LEFT.id,</span><br><span class="line">                          SELF.name := (LEFT.name + &#x27;, &#x27; + RIGHT.job)));</span><br><span class="line"></span><br><span class="line">OUTPUT(ds_join);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="embed">EMBED</h2>
<p>Embedding code in other languages.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EMBED(language)</span><br><span class="line">    embed code.....</span><br><span class="line">ENDEMBED;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">IMPORT Python3 AS Python;</span><br><span class="line"></span><br><span class="line">INTEGER4 MySquare(INTEGER4 val) := EMBED(Python)</span><br><span class="line">    return val * val</span><br><span class="line">ENDEMBED;</span><br><span class="line"></span><br><span class="line">OUTPUT(MySquare(5));    // 25</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="local">LOCAL</h2>
<p>The <code>LOCAL</code> keyword is mainly used to limit the scope of
data or functions, or to control how data is distributed in the
cluster.</p>
<p>If a definition (for example, a dataset or function) is declared
<code>LOCAL</code>, then this definition is only visible in the ECL
statement in which it is declared. This is similar to local variables in
other programming languages. For example:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ECLCopy codemyFunction := FUNCTION</span><br><span class="line">  LOCAL myLocalValue := 5;  // Only available in this function</span><br><span class="line">  RETURN myLocalValue * 2;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>
<p>Additionally, when the <code>LOCAL</code> keyword is used on a
dataset, it indicates that the dataset should be computed locally on
each node, rather than across the entire cluster. This can be useful for
reducing network communication and speeding up calculations. For
example, the following ECL statement creates a dataset that is computed
locally on each node:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ECLCopy code</span><br><span class="line">myLocalDataset := DATASET([&#123;1, &#x27;one&#x27;&#125;, &#123;2, &#x27;two&#x27;&#125;, &#123;3, &#x27;three&#x27;&#125;], myRecordDef, LOCAL);</span><br></pre></td></tr></table></figure>
<p>In this example, <code>myRecordDef</code> is a record definition that
describes the structure of each record in the dataset. Each node will
process a portion of this dataset, not the entire dataset.</p>
<h2 id="assert">ASSERT</h2>
<p>It is often used to judge whether a function has obtained the
expected result.</p>
<p><strong>ASSERT(</strong> <em>condition</em> <strong>[** <em>,
message</em> **] [** , **FAIL ] [** , **CONST ])</strong></p>
<p><strong>ASSERT(</strong> <em>recset, condition</em> <strong>[** <em>,
message</em> **] [** , **FAIL ] [** , **CONST ] [, UNORDERED |
ORDERED(** <em>bool</em> **) ] [, STABLE | UNSTABLE ] [, PARALLEL [ (**
<em>numthreads</em> **) ] ] [, ALGORITHM(** <em>name</em> **) ]</strong>
<strong>)</strong></p>
<p><strong>ASSERT(</strong> <em>recset, assertlist</em> <strong>[,
UNORDERED | ORDERED(** <em>bool</em> **) ] [, STABLE | UNSTABLE ] [,
PARALLEL [ (** <em>numthreads</em> **) ] ] [, ALGORITHM(** <em>name</em>
**) ]</strong> <strong>)</strong></p>
<p>recset can be a DATASET, and ASSERT judges the results one by
one.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">IMPORT Python3 AS Python;</span><br><span class="line">IMPORT Std.System.Thorlib;</span><br><span class="line"></span><br><span class="line">nNodes := Thorlib.nodes();</span><br><span class="line">nodeId := Thorlib.node();</span><br><span class="line">testRec := RECORD</span><br><span class="line">  UNSIGNED node;</span><br><span class="line">  STRING tf_version;</span><br><span class="line">  STRING result := &#x27;&#x27;;</span><br><span class="line">END;</span><br><span class="line">DATASET(testRec) DoTest := FUNCTION</span><br><span class="line">  DATASET(testRec) testTF(DATASET(testRec) test) := EMBED(Python: activity)</span><br><span class="line">    import traceback as tb</span><br><span class="line">    nodeId = 999</span><br><span class="line">    v = 0</span><br><span class="line">    try:</span><br><span class="line">      for tr in test:</span><br><span class="line">        # Should only be one.</span><br><span class="line">        nodeId, unused, result = tr</span><br><span class="line">        try:</span><br><span class="line">          import tensorflow.compat.v1 as tf # V2.x</span><br><span class="line">          tf.disable_v2_behavior()</span><br><span class="line">        except:</span><br><span class="line">          import tensorflow as tf # V 1.x</span><br><span class="line">        s = tf.Session()</span><br><span class="line">        v = tf.__version__</span><br><span class="line">        return [(nodeId, v, &#x27;SUCCESS&#x27;)]</span><br><span class="line">    except:</span><br><span class="line">      return [(nodeId, &#x27;unknown&#x27;, tb.format_exc())]</span><br><span class="line">  ENDEMBED;</span><br><span class="line">  inp := DATASET([&#123;nodeId, &#x27;&#x27;, &#x27;&#x27;&#125;], testRec, LOCAL);</span><br><span class="line">  outp := testTF(inp);</span><br><span class="line">  RETURN ASSERT(outp, result = &#x27;SUCCESS&#x27;, &#x27;Error on node &#x27; + node + &#x27;: &#x27; + result);</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">OUTPUT(DoTest, NAMED(&#x27;Result&#x27;));</span><br></pre></td></tr></table></figure>
<h2 id="sort">SORT</h2>
<p>The <code>SORT</code> function is used to sort the records in the
data set (DATASET) according to the specified field. Its basic usage
syntax is as follows:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SortedDataset := SORT(Dataset, Field);</span><br></pre></td></tr></table></figure>
<p>Here, <code>Dataset</code> is the dataset you want to sort by, and
<code>Field</code> is the field you want to sort by.</p>
<p>A dataset that contains employee information and wants to sort by the
Salary field:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">Employee := RECORD</span><br><span class="line">  STRING20 Name;</span><br><span class="line">  STRING20 Occupation;</span><br><span class="line">  UNSIGNED Salary;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">Employees := DATASET([</span><br><span class="line">  &#123;&#x27;John&#x27;, &#x27;Doctor&#x27;, 80000&#125;,</span><br><span class="line">  &#123;&#x27;Alice&#x27;, &#x27;Engineer&#x27;, 70000&#125;,</span><br><span class="line">  &#123;&#x27;Bob&#x27;, &#x27;Teacher&#x27;, 60000&#125;], Employee);</span><br><span class="line"></span><br><span class="line">SortedEmployees := SORT(Employees, Salary);</span><br><span class="line"></span><br><span class="line">// descending order</span><br><span class="line">SortedEmployees := SORT(Employees, -Salary);</span><br><span class="line">// sort by multiple fields</span><br><span class="line">SortedEmployees := SORT(Employees, Occupation, -Salary);</span><br><span class="line"></span><br><span class="line">OUTPUT(SortedEmployees);</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="max">MAX</h2>
<p>Get the maximum value:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">// create data set</span><br><span class="line">peopleRec := RECORD</span><br><span class="line">  STRING5 name;</span><br><span class="line">  UNSIGNED2 age;</span><br><span class="line">  STRING10 job;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">people := DATASET([</span><br><span class="line">  &#123;&#x27;John&#x27;, 25, &#x27;Teacher&#x27;&#125;,</span><br><span class="line">  &#123;&#x27;Mary&#x27;, 30, &#x27;Engineer&#x27;&#125;,</span><br><span class="line">  &#123;&#x27;Bob&#x27;, 35, &#x27;Engineer&#x27;&#125;,</span><br><span class="line">  &#123;&#x27;Lisa&#x27;, 40, &#x27;Doctor&#x27;&#125;,</span><br><span class="line">  &#123;&#x27;Mike&#x27;, 28, &#x27;Teacher&#x27;&#125;,</span><br><span class="line">  &#123;&#x27;Anna&#x27;, 32, &#x27;Doctor&#x27;&#125;</span><br><span class="line">], peopleRec);</span><br><span class="line"></span><br><span class="line">// Group the dataset by the job field and find the maximum age in each group</span><br><span class="line">test := TABLE(people, &#123;job, maxAge := MAX(GROUP, age)&#125;, job);</span><br><span class="line"></span><br><span class="line">// Find the maximum age among all people without grouping the dataset by the job field</span><br><span class="line">test2 := TABLE(people, &#123;job, maxAge := MAX(GROUP, age)&#125;);</span><br><span class="line"></span><br><span class="line">// output result</span><br><span class="line">OUTPUT(test, NAMED(&#x27;MaxAgePerJob&#x27;));</span><br><span class="line">OUTPUT(test2, NAMED(&#x27;MaxAge&#x27;));</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="count">COUNT</h2>
<p>Calculate the size of the data.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Layout := RECORD</span><br><span class="line">    STRING20 Name;</span><br><span class="line">    UNSIGNED2 Age;</span><br><span class="line">    STRING20 Occupation;</span><br><span class="line">END;</span><br><span class="line"></span><br><span class="line">ds := DATASET([&#123;&#x27;John&#x27;, 30, &#x27;Doctor&#x27;&#125;,</span><br><span class="line">               &#123;&#x27;Alice&#x27;, 25, &#x27;Engineer&#x27;&#125;,</span><br><span class="line">               &#123;&#x27;Bob&#x27;, 35, &#x27;Teacher&#x27;&#125;], Layout);</span><br><span class="line"></span><br><span class="line">dsCount := COUNT(ds);</span><br><span class="line"></span><br><span class="line">OUTPUT(dsCount);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/HPCC-Systems/" rel="tag"><i class="fa fa-tag"></i> HPCC Systems</a>
              <a href="/tags/ECL/" rel="tag"><i class="fa fa-tag"></i> ECL</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/df26575/" rel="prev" title="Install CUDA and TensorFlow in WSL2">
                  <i class="fa fa-chevron-left"></i> Install CUDA and TensorFlow in WSL2
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/4a752ce/" rel="next" title="Debug ECL programming">
                  Debug ECL programming <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Boqiang</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/algoliasearch/4.14.2/algoliasearch-lite.umd.js" integrity="sha256-dImjLPUsG/6p3+i7gVKBiDM8EemJAhQ0VvkRK2pVsQY=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/4.46.3/instantsearch.production.min.js" integrity="sha256-TDBtvQ4sIGgJS5bk8VOKto+yvrblCB/JxE/9odR5u+M=" crossorigin="anonymous"></script><script src="/js/third-party/search/algolia-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>


<script class="next-config" data-name="waline" type="application/json">{"lang":"en-US","enable":true,"serverURL":"waline.boqiangli.com","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":false,"pageview":true,"libUrl":"https://unpkg.com/@waline/client@v2/dist/waline.js","locale":{"placeholder":"Welcome to comment"},"emoji":null,"meta":["nick","mail"],"wordLimit":0,"login":"enable","pageSize":10,"el":"#waline","comment":true,"path":"/post/57ba8585/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

</body>
</html>
